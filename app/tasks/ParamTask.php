<?php

use Phalcon\Cli\Task;

class ParamTask extends Task
{

    private $footerScripts = [
        'lt' =>
            <<<'EOT'
        <div id="om-gmssbdmvmkpglj50-holder"></div><script>var gmssbdmvmkpglj50,gmssbdmvmkpglj50_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){gmssbdmvmkpglj50_poll(function(){if(window['om_loaded']){if(!gmssbdmvmkpglj50){gmssbdmvmkpglj50=new OptinMonsterApp();return gmssbdmvmkpglj50.init({u:"11462.303554",staging:0,dev:0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="//a.optnmnstr.com/app/js/api.min.js",o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;gmssbdmvmkpglj50=new OptinMonsterApp();gmssbdmvmkpglj50.init({u:"11462.303554",staging:0,dev:0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
    <div id="om-fyi02zidebhgsg8v-holder"></div><script>var fyi02zidebhgsg8v,fyi02zidebhgsg8v_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){fyi02zidebhgsg8v_poll(function(){if(window['om_loaded']){if(!fyi02zidebhgsg8v){fyi02zidebhgsg8v=new OptinMonsterApp();return fyi02zidebhgsg8v.init({u:"11462.218873",staging:0,dev:0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="//a.optinmonster.com/app/js/api.min.js",o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;fyi02zidebhgsg8v=new OptinMonsterApp();fyi02zidebhgsg8v.init({u:"11462.218873",staging:0,dev:0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
    <div id="om-gmssbdmvmkpglj50-holder"></div><script>var gmssbdmvmkpglj50,gmssbdmvmkpglj50_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){gmssbdmvmkpglj50_poll(function(){if(window['om_loaded']){if(!gmssbdmvmkpglj50){gmssbdmvmkpglj50=new OptinMonsterApp();return gmssbdmvmkpglj50.init({u:"11462.303554",staging:0,dev:0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="//a.optnmnstr.com/app/js/api.min.js",o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;gmssbdmvmkpglj50=new OptinMonsterApp();gmssbdmvmkpglj50.init({u:"11462.303554",staging:0,dev:0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
    <!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com :: Campaign Title: Šventinės pristatymo kainos --><div id="om-ls3pvgrofjrl9i0x-holder"></div><script>var ls3pvgrofjrl9i0x,ls3pvgrofjrl9i0x_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){ls3pvgrofjrl9i0x_poll(function(){if(window['om_loaded']){if(!ls3pvgrofjrl9i0x){ls3pvgrofjrl9i0x=new OptinMonsterApp();return ls3pvgrofjrl9i0x.init({"u":"11462.479048","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="//a.optnmnstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;ls3pvgrofjrl9i0x=new OptinMonsterApp();ls3pvgrofjrl9i0x.init({"u":"11462.479048","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script><!-- / OptinMonster -->

        <script type="text/javascript">
        window.$zopim||(function(d,s){var z=$zopim=function(c){z._.push(c)},$=z.s=
                d.createElement(s),e=d.getElementsByTagName(s)[0];z.set=function(o){z.set.
        _.push(o)};z._=[];z.set._=[];$.async=!0;$.setAttribute('charset','utf-8');
            $.src='//v2.zopim.com/?42SVyht9EGv3mgnGxf8w5k36uYvzjvuZ';z.t=+new Date;$.
                    type='text/javascript';e.parentNode.insertBefore($,e)})(document,'script');
    </script>
EOT
        ,
        'lv' =>
            <<<'EOT'
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-M8KG3X" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M8KG3X');</script>
<!-- End Google Tag Manager -->

<!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com --><script>var om5608e71652d84,om5608e71652d84_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){om5608e71652d84_poll(function(){if(window['om_loaded']){if(!om5608e71652d84){om5608e71652d84=new OptinMonsterApp();return om5608e71652d84.init({"s":"11462.5608e71652d84","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="//a.optnmnstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;om5608e71652d84=new OptinMonsterApp();om5608e71652d84.init({"s":"11462.5608e71652d84","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script><!-- / OptinMonster -->
<div id="om-uthsh0y0gpo4qpoz-holder"></div><script>var uthsh0y0gpo4qpoz,uthsh0y0gpo4qpoz_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){uthsh0y0gpo4qpoz_poll(function(){if(window['om_loaded']){if(!uthsh0y0gpo4qpoz){uthsh0y0gpo4qpoz=new OptinMonsterApp();return uthsh0y0gpo4qpoz.init({u:"11462.236385",staging:0,dev:0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="//a.optnmnstr.com/app/js/api.min.js",o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;uthsh0y0gpo4qpoz=new OptinMonsterApp();uthsh0y0gpo4qpoz.init({u:"11462.236385",staging:0,dev:0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
EOT

    ];

    private $paramCollection = [
        'site_logo_url' => [
            'lt' => 'bundles/foodapp/images/logo_food.png',
            'lv' => 'bundles/foodapp/images/logo_food2.png',
            'ee' => 'bundles/foodapp/images/logo_food_ee.png'
        ],
        'optin_code' => [
            'lt' => '<div id="om-nkcu3qstsjxkdv12-holder"></div><script>var nkcu3qstsjxkdv12,nkcu3qstsjxkdv12_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){nkcu3qstsjxkdv12_poll(function(){if(window[\'om_loaded\']){if(!nkcu3qstsjxkdv12){nkcu3qstsjxkdv12=new OptinMonsterApp();return nkcu3qstsjxkdv12.init({"u":"11462.367922","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="//a.optnmnstr.com/app/js/api.min.js",o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;nkcu3qstsjxkdv12=new OptinMonsterApp();nkcu3qstsjxkdv12.init({"u":"11462.367922","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>',
            'lv' => '<div id="om-xx1z1otqbssjrm1t-holder"></div><script>var xx1z1otqbssjrm1t,xx1z1otqbssjrm1t_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){xx1z1otqbssjrm1t_poll(function(){if(window[\'om_loaded\']){if(!xx1z1otqbssjrm1t){xx1z1otqbssjrm1t=new OptinMonsterApp();return xx1z1otqbssjrm1t.init({"u":"11462.367923","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="//a.optnmnstr.com/app/js/api.min.js",o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;xx1z1otqbssjrm1t=new OptinMonsterApp();xx1z1otqbssjrm1t.init({"u":"11462.367923","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>',
        ],
        'game_revive_zone_id' => [
            'lt' => 8,
            'lv' => 16,
            'ee' => 16
        ]

    ];

    public function mainAction()
    {

        $di = $this->getDI();


        try {
            $this->db->begin();
            $country = $di->get('config')->params->country;

            if ($this->footerScripts[$country]) {
                $item = Params::findFirstByParam('footer_scripts');

                if (!is_object($item)) {
                    $item = new Params();
                    $item->param = 'footer_scripts';
                }

                $item->value = $this->footerScripts[$country];

                $item->save();
            }
//
//            $query = "INSERT INTO `common_slug_forward` (`id`, `slug`, `locale`, `controller`, `params`) VALUES
//(1, '1822/cili-pica', 'lt', 'FoodDishesBundle:Place:index', \"{'id'':'63','slug':'cili-pica','categoryId':'','oldFriendIsHere':'1'}\"),
//(2, '1822/cili-kaimas', 'lt', 'FoodDishesBundle:Place:index', \"'{'id':'67','slug':'cili-kaimas-kaunas','categoryId':'','oldFriendIsHere':'1'}\"),
//(3, '1822/soya', 'lt', 'FoodDishesBundle:Place:index', \"{'id':'70','slug':'soya','categoryId':'','oldFriendIsHere':'1'}\")";

//            if ($di->get('config')->params->country == 'lt') {
//                $this->db->query($query)->execute();
//            }
            foreach ($this->paramCollection as $paramName => $values) {
                if (isset($values[$country])) {
                    $item = Params::findFirstByParam($paramName);
                    if (!is_object($item)) {
                        $item = new Params();
                        $item->param = $paramName;
                    }
                    $item->value = $values[$country];
                    $item->save();
                }
            }
            $this->db->commit();
        } catch (Exception $e) {
            echo $e->getMessage() . PHP_EOL;
            exit;
        } finally {
            echo 'Params imported succesfully' . PHP_EOL;
        }
    }

}